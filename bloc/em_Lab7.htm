<html>

<head>

<meta http-equiv=Content-Type content="text/html; charset=gb2312">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Helvetica;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:宋体;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:"MS Gothic";
	panose-1:2 11 6 9 7 2 5 8 2 4;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Simsun;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:PingFangSC-Regular;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@宋体";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:"\@MS Gothic";
	panose-1:2 11 6 9 7 2 5 8 2 4;}
@font-face
	{font-family:"\@PingFangSC-Regular";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:"Calibri",sans-serif;}
h1
	{mso-style-link:"标题 1 Char";
	margin-top:17.0pt;
	margin-right:0cm;
	margin-bottom:16.5pt;
	margin-left:0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:240%;
	page-break-after:avoid;
	font-size:22.0pt;
	font-family:"Calibri",sans-serif;
	font-weight:bold;}
h2
	{mso-style-link:"标题 2 Char";
	margin-right:0cm;
	margin-left:0cm;
	font-size:18.0pt;
	font-family:宋体;
	font-weight:bold;}
h3
	{mso-style-link:"标题 3 Char";
	margin-top:13.0pt;
	margin-right:0cm;
	margin-bottom:13.0pt;
	margin-left:0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:173%;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"Calibri",sans-serif;
	font-weight:bold;}
a:link, span.MsoHyperlink
	{color:#0563C1;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:#954F72;
	text-decoration:underline;}
p
	{margin-right:0cm;
	margin-left:0cm;
	font-size:12.0pt;
	font-family:宋体;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:21.0pt;
	font-size:10.5pt;
	font-family:"Calibri",sans-serif;}
span.2Char
	{mso-style-name:"标题 2 Char";
	mso-style-link:"标题 2";
	font-family:宋体;
	font-weight:bold;}
span.1Char
	{mso-style-name:"标题 1 Char";
	mso-style-link:"标题 1";
	font-weight:bold;}
span.3Char
	{mso-style-name:"标题 3 Char";
	mso-style-link:"标题 3";
	font-weight:bold;}
.MsoChpDefault
	{font-family:"Calibri",sans-serif;}
 /* Page Definitions */
 @page WordSection1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	layout-grid:15.6pt;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>

</head>

<body lang=ZH-CN link="#0563C1" vlink="#954F72" style='text-justify-trim:punctuation'>

<div class=WordSection1 style='layout-grid:15.6pt'>

<p class=MsoNormal align=center style='text-align:center;line-height:150%'><b><span
lang=EN-US style='font-size:18.0pt;line-height:150%;font-family:"Simsun",serif;
color:black'>Lab 7</span></b><b><span style='font-size:18.0pt;line-height:150%;
font-family:宋体;color:black'>：字符设备驱动程序</span></b></p>

<p class=MsoListParagraph align=left style='margin-left:21.0pt;text-align:left;
text-indent:-21.0pt;line-height:150%'><span lang=EN-US style='font-family:Wingdings'>l<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
style='font-family:宋体'>这个实验的目的是掌握在嵌入式</span><span lang=EN-US>Linux</span><span
style='font-family:宋体'>中如何使用已有的函数库编写应用程序操纵</span><span lang=EN-US>GPIO</span><span
style='font-family:宋体'>，如何编写字符设备驱动程</span> <span style='font-family:宋体'>序在内核程序中使用</span><span
lang=EN-US>GPIO</span><span style='font-family:宋体'>，并学习用面包板搭简单的外部设备电路的方法。</span></p>

<p class=MsoListParagraph align=left style='margin-left:21.0pt;text-align:left;
text-indent:-21.0pt;line-height:150%'><span lang=EN-US style='font-family:Wingdings'>l<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
style='font-family:宋体'>实验要求在</span><span lang=EN-US>Linux</span><span
style='font-family:宋体'>板卡上连接两个级联的</span><span lang=EN-US>74HC595</span><span
style='font-family:宋体'>，由</span><span lang=EN-US>595</span><span
style='font-family:宋体'>的输出端控制一个</span><span lang=EN-US>8x8</span><span
style='font-family:宋体'>的</span><span lang=EN-US>LED</span><span
style='font-family:宋体'>矩阵。通过两个</span><span lang=EN-US>GPIO</span><span
style='font-family:宋体'>引脚</span> <span style='font-family:宋体'>分别控制</span><span
lang=EN-US>595</span><span style='font-family:宋体'>的时钟和数据输入端，可以实现对</span><span
lang=EN-US>LED</span><span style='font-family:宋体'>矩阵的控制，在矩阵上显示文字和图案。</span></p>

<h2><span style='color:black'>实验目的</span></h2>

<p class=MsoNormal align=left style='margin-left:35.7pt;text-align:left;
text-indent:-17.85pt;line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:"Simsun",serif;color:black'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='line-height:150%;font-family:宋体;color:black'>学习嵌入式</span><span
lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>Linux</span><span
style='line-height:150%;font-family:宋体;color:black'>的</span><span lang=EN-US
style='line-height:150%;font-family:"Simsun",serif;color:black'>GPIO</span><span
style='line-height:150%;font-family:宋体;color:black'>的使用方式；</span></p>

<p class=MsoNormal align=left style='margin-left:35.7pt;text-align:left;
text-indent:-17.85pt;line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:"Simsun",serif;color:black'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='line-height:150%;font-family:宋体;color:black'>学习嵌入式</span><span
lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>Linux</span><span
style='line-height:150%;font-family:宋体;color:black'>的</span><span lang=EN-US
style='line-height:150%;font-family:"Simsun",serif;color:black'>Arduino</span><span
style='line-height:150%;font-family:宋体;color:black'>接口库；</span></p>

<p class=MsoNormal align=left style='margin-left:35.7pt;text-align:left;
text-indent:-17.85pt;line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:"Simsun",serif;color:black'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='line-height:150%;font-family:宋体;color:black'>学习使用面包板搭简单的外部电路；</span></p>

<p class=MsoNormal align=left style='margin-left:35.7pt;text-align:left;
text-indent:-17.85pt;line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:"Simsun",serif;color:black'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='line-height:150%;font-family:宋体;color:black'>学习</span><span
lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>Linux</span><span
style='line-height:150%;font-family:宋体;color:black'>设备驱动程序的开发过程。</span></p>

<p class=MsoNormal align=left style='margin-left:35.7pt;text-align:left;
text-indent:-17.85pt;line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:"Simsun",serif;color:black'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='line-height:150%;font-family:宋体;color:black'>学习在内核中访问外设寄存器，操纵外设的方法。</span></p>

<h2><span style='color:black'>实验器材</span></h2>

<h3><span style='font-family:宋体;color:black'>硬件</span></h3>

<p class=MsoNormal align=left style='margin-left:35.7pt;text-align:left;
text-indent:-17.85pt;line-height:150%'><span lang=EN-US style='font-size:10.0pt;
line-height:150%;font-family:Symbol;color:black'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US style='line-height:150%;font-family:"Simsun",serif;
color:black'>Linux</span><span style='line-height:150%;font-family:宋体;
color:black'>实验板卡一块；</span></p>

<p class=MsoNormal align=left style='margin-left:35.7pt;text-align:left;
text-indent:-17.85pt;line-height:150%'><span lang=EN-US style='font-size:10.0pt;
line-height:150%;font-family:Symbol;color:black'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US style='line-height:150%;font-family:"Simsun",serif;
color:black'>5V/1A</span><span style='line-height:150%;font-family:宋体;
color:black'>电源一个；</span></p>

<p class=MsoNormal align=left style='margin-left:35.7pt;text-align:left;
text-indent:-17.85pt;line-height:150%'><span lang=EN-US style='font-size:10.0pt;
line-height:150%;font-family:Symbol;color:black'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US style='line-height:150%;font-family:"Simsun",serif;
color:black'>microUSB</span><span style='line-height:150%;font-family:宋体;
color:black'>线一根；</span></p>

<p class=MsoNormal align=left style='margin-left:35.7pt;text-align:left;
text-indent:-17.85pt;line-height:150%'><span lang=EN-US style='font-size:10.0pt;
line-height:150%;font-family:Symbol;color:black'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='line-height:150%;font-family:宋体;color:black'>面包板一块；</span></p>

<p class=MsoNormal align=left style='margin-left:35.7pt;text-align:left;
text-indent:-17.85pt;line-height:150%'><span lang=EN-US style='font-size:10.0pt;
line-height:150%;font-family:Symbol;color:black'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US style='line-height:150%;font-family:"Simsun",serif;
color:black'>MAX7219</span><span style='line-height:150%;font-family:宋体;
color:black'>驱动的</span><span lang=EN-US style='line-height:150%;font-family:
"Simsun",serif;color:black'>8x8 LED</span><span style='line-height:150%;
font-family:宋体;color:black'>矩阵一个；</span></p>

<p class=MsoNormal align=left style='margin-left:35.7pt;text-align:left;
text-indent:-17.85pt;line-height:150%'><span lang=EN-US style='font-size:10.0pt;
line-height:150%;font-family:Symbol;color:black'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='line-height:150%;font-family:宋体;color:black'>面包线若干。</span></p>

<p><span style='font-size:13.5pt;color:black'>以下为自备（可选）器材：</span></p>

<p class=MsoNormal align=left style='margin-left:35.7pt;text-align:left;
text-indent:-17.85pt;line-height:150%'><span lang=EN-US style='font-size:10.0pt;
line-height:150%;font-family:Symbol;color:black'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US style='line-height:150%;font-family:"Simsun",serif;
color:black'>PC</span><span style='line-height:150%;font-family:宋体;color:black'>（</span><span
lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>Windows/Mac
OS/Linux</span><span style='line-height:150%;font-family:宋体;color:black'>）一台；</span></p>

<p class=MsoNormal align=left style='margin-left:35.7pt;text-align:left;
text-indent:-17.85pt;line-height:150%'><span lang=EN-US style='font-size:10.0pt;
line-height:150%;font-family:Symbol;color:black'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US style='line-height:150%;font-family:"Simsun",serif;
color:black'>USB-TTL</span><span style='line-height:150%;font-family:宋体;
color:black'>串口线一根（</span><span lang=EN-US style='line-height:150%;font-family:
"Simsun",serif;color:black'>FT232RL</span><span style='line-height:150%;
font-family:宋体;color:black'>芯片或</span><span lang=EN-US style='line-height:150%;
font-family:"Simsun",serif;color:black'>PL2303</span><span style='line-height:
150%;font-family:宋体;color:black'>芯片）；</span></p>

<p class=MsoNormal align=left style='margin-left:35.7pt;text-align:left;
text-indent:-17.85pt;line-height:150%'><span lang=EN-US style='font-size:10.0pt;
line-height:150%;font-family:Symbol;color:black'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='line-height:150%;font-family:宋体;color:black'>以太网线一根（可能还需要路由器等）。</span></p>

<h3><span style='font-family:宋体;color:black'>软件</span></h3>

<p class=MsoNormal align=left style='margin-left:35.7pt;text-align:left;
text-indent:-17.85pt;line-height:150%'><span lang=EN-US style='font-size:10.0pt;
line-height:150%;font-family:Symbol;color:black'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='line-height:150%;font-family:宋体;color:black'>编译软件；</span></p>

<p class=MsoNormal align=left style='margin-left:35.7pt;text-align:left;
text-indent:-17.85pt;line-height:150%'><span lang=EN-US style='font-size:10.0pt;
line-height:150%;font-family:Symbol;color:black'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US style='line-height:150%;font-family:"Simsun",serif;
color:black'>Fritzing</span></p>

<h2><span style='color:black'>实验步骤</span></h2>

<p class=MsoListParagraph align=left style='margin-left:18.0pt;text-align:left;
text-indent:-18.0pt;line-height:150%'><b><span lang=EN-US style='line-height:
150%;font-family:"Simsun",serif;color:black'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></b><b><span style='line-height:150%;font-family:宋体;color:black'>设计方案，画连线示意图。</span></b></p>

<p class=MsoListParagraph align=left style='margin-left:18.0pt;text-align:left;
text-indent:-18.0pt;line-height:150%'><b><span lang=EN-US style='line-height:
150%;font-family:"Simsun",serif;color:black'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></b><b><span style='line-height:150%;font-family:宋体;color:black'>在面包板上连线，完成外部电路。</span></b></p>

<p class=MsoNormal align=left style='text-align:left;line-height:150%;
text-autospace:none'><span style='line-height:150%;font-family:宋体;color:black'>本次实验使用</span><span
lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>wiringPi</span><span
style='line-height:150%;font-family:宋体;color:black'>库函数，</span><span
style='font-size:11.0pt;line-height:150%;font-family:宋体;color:black'>下载链接为</span><span
lang=EN-US><a href="https://github.com/WiringPi/WiringPi"><span
style='font-size:11.0pt;line-height:150%;font-family:"Helvetica",sans-serif'>https://github.com/WiringPi/WiringPi</span></a></span><span
style='font-size:11.0pt;line-height:150%;font-family:宋体;color:#4184C5'>。</span><span
style='line-height:150%;font-family:宋体;color:black'>设计树莓派与</span><span
lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>LED</span><span
style='line-height:150%;font-family:宋体;color:black'>连接。接线方案如下：</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=184 valign=top style='width:138.25pt;border:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><b><span
  style='line-height:150%;font-family:宋体;color:black'>树莓派</span></b></p>
  </td>
  <td width=184 valign=top style='width:138.25pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><b><span
  lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>LED</span></b></p>
  </td>
 </tr>
 <tr>
  <td width=184 valign=top style='width:138.25pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>VCC</span></p>
  </td>
  <td width=184 valign=top style='width:138.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>VCC</span></p>
  </td>
 </tr>
 <tr>
  <td width=184 valign=top style='width:138.25pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>GND</span></p>
  </td>
  <td width=184 valign=top style='width:138.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>GND</span></p>
  </td>
 </tr>
 <tr>
  <td width=184 valign=top style='width:138.25pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>GPIO0</span></p>
  </td>
  <td width=184 valign=top style='width:138.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>DIN</span></p>
  </td>
 </tr>
 <tr>
  <td width=184 valign=top style='width:138.25pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>GPIO2</span></p>
  </td>
  <td width=184 valign=top style='width:138.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>CS</span></p>
  </td>
 </tr>
 <tr>
  <td width=184 valign=top style='width:138.25pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>GPIO3</span></p>
  </td>
  <td width=184 valign=top style='width:138.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
  lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>CLK</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'><img
border=0 width=445 height=294 src="em_Lab7.files/image001.png"></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
style='line-height:150%;font-family:宋体;color:black'>具体连线拍照效果可见后文。</span></p>

<p class=MsoListParagraph align=left style='margin-left:18.0pt;text-align:left;
text-indent:-18.0pt;line-height:150%'><b><span lang=EN-US style='line-height:
150%;font-family:"Simsun",serif;color:black'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></b><b><span style='line-height:150%;font-family:宋体;color:black'>编写</span></b><b><span
lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>C/C++</span></b><b><span
style='line-height:150%;font-family:宋体;color:black'>程序，采用</span></b><b><span
lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>Arduino-ish</span></b><b><span
style='line-height:150%;font-family:宋体;color:black'>库或虚拟文件系统访问</span></b><b><span
lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>GPIO</span></b><b><span
style='line-height:150%;font-family:宋体;color:black'>，实现在矩阵上显示文字或图案。</span></b></p>

<p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
style='line-height:150%;font-family:宋体;color:black'>使用</span><span lang=EN-US
style='line-height:150%;font-family:"Simsun",serif;color:black'>wiringPi</span><span
style='line-height:150%;font-family:宋体;color:black'>库函数来控制树莓派的</span><span
lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>GPIO</span><span
style='line-height:150%;font-family:宋体;color:black'>。下载到本地需要</span><span
lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>./build</span><span
style='line-height:150%;font-family:宋体;color:black'>编译后就可以使用，编程中引入头文件即可。当然编译的时候，需要加上“</span><span
lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>–lwiringPi</span><span
style='line-height:150%;font-family:宋体;color:black'>”链接入库。</span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
style='line-height:150%;font-family:宋体;color:black'>整个写入流程是首先需要把</span><span
lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>CS</span><span
style='line-height:150%;font-family:宋体;color:black'>引脚置</span><span lang=EN-US
style='line-height:150%;font-family:"Simsun",serif;color:black'>0</span><span
style='line-height:150%;font-family:宋体;color:black'>，表示允许写入。而后从高位顺序写入</span><span
lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>16</span><span
style='line-height:150%;font-family:宋体;color:black'>个</span><span lang=EN-US
style='line-height:150%;font-family:"Simsun",serif;color:black'>bit</span><span
style='line-height:150%;font-family:宋体;color:black'>。每个</span><span lang=EN-US
style='line-height:150%;font-family:"Simsun",serif;color:black'>bit</span><span
style='line-height:150%;font-family:宋体;color:black'>的写入方式为首先</span><span
lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>DIN</span><span
style='line-height:150%;font-family:宋体;color:black'>置为要写入的</span><span
lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>bit</span><span
style='line-height:150%;font-family:宋体;color:black'>值，而后</span><span
lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>CLK</span><span
style='line-height:150%;font-family:宋体;color:black'>产生一个下降沿（图中为上升沿，不知道为何有差别）即被读入。最后</span><span
lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>CS</span><span
style='line-height:150%;font-family:宋体;color:black'>引脚置</span><span lang=EN-US
style='line-height:150%;font-family:"Simsun",serif;color:black'>1</span><span
style='line-height:150%;font-family:宋体;color:black'>表示写入结束。而除了数据传输流程之外，接下来是如何在点阵上显示图案了。在运行之前，需要进行一次初始化，其行为是向某几个特定的地址写入特定的值。至少需要写入两个地址，第一个是</span><span
lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>0x0b</span><span
style='line-height:150%;font-family:宋体;color:black'>，写入</span><span lang=EN-US
style='line-height:150%;font-family:"Simsun",serif;color:black'>0x07</span><span
style='line-height:150%;font-family:宋体;color:black'>表示扫描显示所有行。第二个是</span><span
lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>0x0c</span><span
style='line-height:150%;font-family:宋体;color:black'>，写入</span><span lang=EN-US
style='line-height:150%;font-family:"Simsun",serif;color:black'>1</span><span
style='line-height:150%;font-family:宋体;color:black'>表示进入工作模式。而后点阵上每一行都有其地址，如第一行是</span><span
lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>0x01</span><span
style='line-height:150%;font-family:宋体;color:black'>到第八行是</span><span
lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>0x08</span><span
style='line-height:150%;font-family:宋体;color:black'>，每次向固定行的地址写入一个</span><span
lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>8</span><span
style='line-height:150%;font-family:宋体;color:black'>位二进制数即可在指定行上显示图案。</span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
style='line-height:150%;font-family:宋体;color:black'>代码如下：</span></p>

<table class=MsoTableGrid border=0 cellspacing=0 cellpadding=0
 style='background:#E7E6E6;border-collapse:collapse;border:none'>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>#include &lt;wiringPi.h&gt;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>#define uchar unsigned char</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>#define uint&nbsp; unsigned
  int</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>int CLK = 0;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>int CS = 2;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>int DIN = 3; </span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>uchar disp1[38][8]={</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x3C,0x42,0x42,0x42,0x42,0x42,0x42,0x3C},//0</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x10,0x18,0x14,0x10,0x10,0x10,0x10,0x10},//1</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x7E,0x2,0x2,0x7E,0x40,0x40,0x40,0x7E},//2</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x3E,0x2,0x2,0x3E,0x2,0x2,0x3E,0x0},//3</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x8,0x18,0x28,0x48,0xFE,0x8,0x8,0x8},//4</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x3C,0x20,0x20,0x3C,0x4,0x4,0x3C,0x0},//5</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x3C,0x20,0x20,0x3C,0x24,0x24,0x3C,0x0},//6</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x3E,0x22,0x4,0x8,0x8,0x8,0x8,0x8},//7</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x0,0x3E,0x22,0x22,0x3E,0x22,0x22,0x3E},//8</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x3E,0x22,0x22,0x3E,0x2,0x2,0x2,0x3E},//9</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x8,0x14,0x22,0x3E,0x22,0x22,0x22,0x22},//A</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x3C,0x22,0x22,0x3E,0x22,0x22,0x3C,0x0},//B</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x3C,0x40,0x40,0x40,0x40,0x40,0x3C,0x0},//C</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x7C,0x42,0x42,0x42,0x42,0x42,0x7C,0x0},//D</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x7C,0x40,0x40,0x7C,0x40,0x40,0x40,0x7C},//E</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x7C,0x40,0x40,0x7C,0x40,0x40,0x40,0x40},//F</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x3C,0x40,0x40,0x40,0x40,0x44,0x44,0x3C},//G</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x44,0x44,0x44,0x7C,0x44,0x44,0x44,0x44},//H</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x7C,0x10,0x10,0x10,0x10,0x10,0x10,0x7C},//I</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x3C,0x8,0x8,0x8,0x8,0x8,0x48,0x30},//J</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x0,0x24,0x28,0x30,0x20,0x30,0x28,0x24},//K</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x40,0x40,0x40,0x40,0x40,0x40,0x40,0x7C},//L</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x81,0xC3,0xA5,0x99,0x81,0x81,0x81,0x81},//M</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x0,0x42,0x62,0x52,0x4A,0x46,0x42,0x0},//N</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x3C,0x42,0x42,0x42,0x42,0x42,0x42,0x3C},//O</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x3C,0x22,0x22,0x22,0x3C,0x20,0x20,0x20},//P</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x1C,0x22,0x22,0x22,0x22,0x26,0x22,0x1D},//Q</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x3C,0x22,0x22,0x22,0x3C,0x24,0x22,0x21},//R</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x0,0x1E,0x20,0x20,0x3E,0x2,0x2,0x3C},//S</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x0,0x3E,0x8,0x8,0x8,0x8,0x8,0x8},//T</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x42,0x42,0x42,0x42,0x42,0x42,0x22,0x1C},//U</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x42,0x42,0x42,0x42,0x42,0x42,0x24,0x18},//V</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x0,0x49,0x49,0x49,0x49,0x2A,0x1C,0x0},//W</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x0,0x41,0x22,0x14,0x8,0x14,0x22,0x41},//X</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x41,0x22,0x14,0x8,0x8,0x8,0x8,0x8},//Y</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x0,0x7F,0x2,0x4,0x8,0x10,0x20,0x7F},//Z</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0x8,0x7F,0x49,0x49,0x7F,0x8,0x8,0x8},//</span><span
  style='font-family:宋体;color:black'>中</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{0xFE,0xBA,0x92,0xBA,0x92,0x9A,0xBA,0xFE},//</span><span
  style='font-family:宋体;color:black'>国</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>};</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>//--------------------------------------------</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>//</span><span
  style='font-family:宋体;color:black'>功能：向</span><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>MAX7219(U3)</span><span
  style='font-family:宋体;color:black'>写入字节</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>//</span><span
  style='font-family:宋体;color:black'>入口参数：</span><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>DATA </span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>//</span><span
  style='font-family:宋体;color:black'>出口参数：无</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>//</span><span
  style='font-family:宋体;color:black'>说明：</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>void Write_Max7219_byte(uchar
  DATA)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp; uchar
  i;&nbsp;&nbsp;&nbsp; </span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp;
  digitalWrite(CS,LOW);&nbsp; </span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp; for(i = 8; i &gt;= 1;
  i--)</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp;
  {&nbsp;&nbsp;&nbsp;&nbsp; </span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp;&nbsp;&nbsp;
  digitalWrite(CLK, LOW);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp;&nbsp;&nbsp;
  //Max7219_pinDIN = DATA &amp; 0x80;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp;&nbsp;&nbsp; if(DATA
  &amp; 0x80)</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  digitalWrite(DIN,HIGH);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp;&nbsp;&nbsp; else</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  digitalWrite(DIN,LOW);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp;&nbsp;&nbsp; DATA = DATA
  &lt;&lt; 1;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp;&nbsp;&nbsp;
  digitalWrite(CLK, HIGH);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp;
  }&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>}</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>//-------------------------------------------</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>//</span><span
  style='font-family:宋体;color:black'>功能：向</span><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>MAX7219</span><span
  style='font-family:宋体;color:black'>写入数据</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>//</span><span
  style='font-family:宋体;color:black'>入口参数：</span><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>address</span><span
  style='font-family:宋体;color:black'>、</span><span lang=EN-US style='font-family:
  "Simsun",serif;color:black'>dat</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>//</span><span
  style='font-family:宋体;color:black'>出口参数：无</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>//</span><span
  style='font-family:宋体;color:black'>说明：</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>void Write_Max7219(uchar address,uchar
  dat)</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{ </span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp; digitalWrite(CS, LOW);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp;
  Write_Max7219_byte(address);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  //</span><span style='font-family:宋体;color:black'>写入地址，即数码管编号</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp;
  Write_Max7219_byte(dat);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  //</span><span style='font-family:宋体;color:black'>写入数据，即数码管显示数字</span><span
  style='font-family:"Simsun",serif;color:black'> </span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp; digitalWrite(CS, HIGH);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>}</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>void Init_MAX7219(void)</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp; Write_Max7219(0x09,
  0x00);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //</span><span style='font-family:
  宋体;color:black'>译码方式：</span><span lang=EN-US style='font-family:"Simsun",serif;
  color:black'>BCD</span><span style='font-family:宋体;color:black'>码</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp; Write_Max7219(0x0a,
  0x03);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //</span><span style='font-family:
  宋体;color:black'>亮度</span><span style='font-family:"Simsun",serif;color:black'>
  </span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp; Write_Max7219(0x0b,
  0x07);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //</span><span style='font-family:
  宋体;color:black'>扫描界限；</span><span lang=EN-US style='font-family:"Simsun",serif;
  color:black'>8</span><span style='font-family:宋体;color:black'>个数码管显示</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp; Write_Max7219(0x0c,
  0x01);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //</span><span style='font-family:
  宋体;color:black'>掉电模式：</span><span lang=EN-US style='font-family:"Simsun",serif;
  color:black'>0</span><span style='font-family:宋体;color:black'>，普通模式：</span><span
  lang=EN-US style='font-family:"Simsun",serif;color:black'>1</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp; Write_Max7219(0x0f,
  0x00);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //</span><span style='font-family:
  宋体;color:black'>显示测试：</span><span lang=EN-US style='font-family:"Simsun",serif;
  color:black'>1</span><span style='font-family:宋体;color:black'>；测试结束，正常显示：</span><span
  lang=EN-US style='font-family:"Simsun",serif;color:black'>0</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>}</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>int mian()</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>{</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wiringPiSetup();
  //wiringPi</span><span style='font-family:宋体;color:black'>初始化</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp;&nbsp;&nbsp;
  pinMode(CLK, OUTPUT);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp;&nbsp;&nbsp; pinMode(CS,
  OUTPUT);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp;&nbsp;&nbsp;
  pinMode(DIN, OUTPUT);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp;&nbsp;&nbsp; uchar i, j;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp;&nbsp;&nbsp; delay(50);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp;&nbsp;&nbsp;
  Init_MAX7219();</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp;&nbsp;&nbsp; while (1) {</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  for(j=0;j&lt;38;j++)</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  {</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  for(i=1;i&lt;9;i++)</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  Write_Max7219(i, disp1[j][i-1]);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  delay(1000);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  }&nbsp; </span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>&nbsp;&nbsp;&nbsp; }</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='font-family:"Simsun",serif;color:black'>}</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
style='line-height:150%;font-family:宋体;color:black'>之后使用</span><span
lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>gcc
test.cpp –lwiringPi</span><span style='line-height:150%;font-family:宋体;
color:black'>命令编译即可。运行文件时需要</span><span lang=EN-US style='line-height:150%;
font-family:"Simsun",serif;color:black'>root</span><span style='line-height:
150%;font-family:宋体;color:black'>，否则会运行失败。结果图：</span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
lang=EN-US><img border=0 width=281 height=252 id="图片 1"
src="em_Lab7.files/image002.png"></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
lang=EN-US><img border=0 width=282 height=258 id="图片 2"
src="em_Lab7.files/image003.png"></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
lang=EN-US><img border=0 width=281 height=266 id="图片 3"
src="em_Lab7.files/image004.png"></span></p>

<p class=MsoListParagraph align=left style='margin-left:18.0pt;text-align:left;
text-indent:-18.0pt;line-height:150%'><b><span lang=EN-US style='line-height:
150%;font-family:"Simsun",serif;color:black'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></b><b><span style='line-height:150%;font-family:宋体;color:black'>编写字符设备驱动程序，直接访问</span></b><b><span
lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>GPIO</span></b><b><span
style='line-height:150%;font-family:宋体;color:black'>控制寄存器，能将</span></b><b><span
lang=EN-US style='line-height:150%;font-family:"Simsun",serif;color:black'>write()</span></b><b><span
style='line-height:150%;font-family:宋体;color:black'>送来的单个字符在矩阵上显示出来。</span></b></p>

<p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
style='font-family:宋体'>和上一个实验一样需要首先编写内核模块。之后编译内核装载即可。装载之后可以在</span><span
lang=EN-US>dev</span><span style='font-family:宋体'>目录下看到新的模块。这里有个坑就是，内核中的</span><span
lang=EN-US>GPIO</span><span style='font-family:宋体'>脚编号和之前实验中的</span><span
lang=EN-US>GPIO</span><span style='font-family:宋体'>脚编号不一致。这里需要修改一下。写入的时候出发模块中的</span><span
lang=EN-US>matrix_write</span><span style='font-family:宋体'>函数，这和之前操作系统中文件操作的方法类似。代码如下：</span></p>

<table class=MsoTableGrid border=0 cellspacing=0 cellpadding=0
 style='background:#E7E6E6;border-collapse:collapse;border:none'>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>#include
  &lt;linux/init.h&gt;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>#include
  &lt;linux/kernel.h&gt;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>#include
  &lt;linux/module.h&gt;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>#include
  &lt;linux/moduleparam.h&gt;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>#include
  &lt;linux/fs.h&gt;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>#include
  &lt;linux/miscdevice.h&gt;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>#include
  &lt;linux/string.h&gt;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>#include
  &lt;linux/delay.h&gt;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>#include
  &lt;linux/gpio.h&gt;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>#include
  &lt;linux/workqueue.h&gt;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>MODULE_LICENSE(&quot;GPL&quot;);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>#define
  DIN 17 //</span><span style='font-family:宋体'>原来的</span><span lang=EN-US>0</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>#define
  CS 27 //</span><span style='font-family:宋体'>原来的</span><span lang=EN-US>GPIO.2</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>#define
  CLK 55 //</span><span style='font-family:宋体'>原来的</span><span lang=EN-US>GPIO.3</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>#define
  BUFFERSIZE 128</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>#define
  DELAYTIME 1</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>unsigned
  char disp[BUFFERSIZE];</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>int
  head = 0, tail = 0;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>static
  struct timer_list timer;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>void
  write_byte(unsigned char b){</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  unsigned char i, tmp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  for (i=0; i&lt;8; i++){</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  tmp = (b &amp; 0x80) &gt; 0;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  b &lt;&lt;= 1;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  gpio_set_value(DIN, tmp);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  gpio_set_value(CLK, 1);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  gpio_set_value(CLK, 0);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  }</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>}</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>void
  write_word(unsigned char addr, unsigned char num){</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  gpio_set_value(CLK, 0);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  gpio_set_value(CS, 1);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  gpio_set_value(CS, 0);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  write_byte(addr);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  write_byte(num);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  gpio_set_value(CS, 1);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>}</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>void
  Matrix_render(unsigned char* tmp){</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  int i;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  for (i=0; i&lt;8; i++){</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  write_word(i+1, tmp[i]);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  }</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>}</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>unsigned
  char digits[][8]={</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  {0x1c, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x1c}, // 0</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  {0x08, 0x18, 0x08, 0x08, 0x08, 0x08, 0x08, 0x1c}, // 1</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  {0x1c, 0x22, 0x22, 0x04, 0x08, 0x10, 0x20, 0x3e}, // 2</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  {0x1c, 0x22, 0x02, 0x0c, 0x02, 0x02, 0x22, 0x1c}, // 3</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  {0x04, 0x0c, 0x14, 0x14, 0x24, 0x1e, 0x04, 0x04}, // 4</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  {0x3e, 0x20, 0x20, 0x3c, 0x02, 0x02, 0x22, 0x1c}, // 5</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  {0x1c, 0x22, 0x20, 0x3c, 0x22, 0x22, 0x22, 0x1c}, // 6</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  {0x3e, 0x24, 0x04, 0x08, 0x08, 0x08, 0x08, 0x08}, // 7</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  {0x1c, 0x22, 0x22, 0x1c, 0x22, 0x22, 0x22, 0x1c}, // 8</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  {0x1c, 0x22, 0x22, 0x22, 0x1e, 0x02, 0x22, 0x1c}, // 9</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>};</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>unsigned
  char LM[]={</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  0x80, 0x80, 0x80, 0x91, 0x9b, 0xf5, 0x11, 0x11</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>};</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>void
  Matrix_clear(void){</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  Matrix_render(LM);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>}</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>void
  Matrix_init(void){</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  write_word(0x09, 0x00);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  write_word(0x0a, 0x03);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  write_word(0x0b, 0x07);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  write_word(0x0c, 0x01);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  Matrix_clear();</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>}</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>void
  Matrix_next_display(unsigned long);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>void
  ptr_inc(int *ptr){</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  *ptr = (*ptr + 1) % BUFFERSIZE;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>}</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>static
  void timer_register(struct timer_list* ptimer){</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  init_timer(ptimer);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  ptimer-&gt;data = DELAYTIME;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  ptimer-&gt;expires = jiffies + (DELAYTIME * HZ);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  ptimer-&gt;function = Matrix_next_display;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  add_timer(ptimer);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>}</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>void
  disp_start(void){</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  timer_register(&amp;timer);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>}</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>void
  Matrix_next_display(unsigned long data){</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  if (head != tail){</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  unsigned char *ptr = LM;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  unsigned char c = disp[head];</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  if ('0' &lt;= c &amp;&amp; c &lt;= '9'){</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  ptr = digits[c - '0'];</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  }</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  Matrix_render(ptr);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  ptr_inc(&amp;head);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  disp_start();</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  }else{</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  Matrix_clear();</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  }</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>}</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>static
  int matrix_write(struct file *file, const char __user *buffer,</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  size_t count, loff_t *ppos){</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  int i;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  if (head == tail &amp;&amp; count &gt; 0){</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  disp_start();</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  }</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  for (i=0; i&lt;count; i++){</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  ptr_inc(&amp;tail);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  if (tail == head)</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  ptr_inc(&amp;head);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  disp[tail] = buffer[i];</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  }</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  return count;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>}</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>static
  struct file_operations matrix_fops = {</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  .owner = THIS_MODULE,</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  .write = matrix_write,</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  .llseek = noop_llseek</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>};</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>static
  struct miscdevice matrix_misc_device = {</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  .minor = MISC_DYNAMIC_MINOR,</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  .name = &quot;matrix&quot;,</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  .fops = &amp;matrix_fops</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>};</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>static
  int __init matrix_init(void){</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  misc_register(&amp;matrix_misc_device);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  gpio_request(DIN, &quot;sysfs&quot;);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  gpio_direction_output(DIN, 0);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  gpio_request(CS, &quot;sysfs&quot;);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  gpio_direction_output(CS, 1);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  gpio_request(CLK, &quot;sysfs&quot;);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  gpio_direction_output(CLK, 0);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  Matrix_init();&nbsp; </span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  return 0;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>}</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>static
  void __exit matrix_exit(void){</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  misc_deregister(&amp;matrix_misc_device);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;&nbsp;&nbsp;
  del_timer(&amp;timer);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>}</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>module_init(matrix_init);</span></p>
  </td>
 </tr>
 <tr>
  <td width=553 valign=top style='width:414.8pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US>module_exit(matrix_exit);</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
style='font-family:宋体'>之后</span><span lang=EN-US>make</span><span
style='font-family:宋体'>编译内核，</span><span lang=EN-US>makefile</span><span
style='font-family:宋体'>和上个实验一致。生成内核模块，就可以安装内核了。</span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
lang=EN-US><img border=0 width=455 height=61 id="图片 4"
src="em_Lab7.files/image005.png"></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
style='font-family:宋体'>往</span><span lang=EN-US>/dev/matrix</span><span
style='font-family:宋体'>中输入数字，就可以看到结果了：</span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
lang=EN-US><img border=0 width=510 height=316 id="图片 5"
src="em_Lab7.files/image006.png"></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
lang=EN-US><img border=0 width=507 height=274 id="图片 6"
src="em_Lab7.files/image007.png"></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
lang=EN-US><img border=0 width=483 height=323 id="图片 8"
src="em_Lab7.files/image008.png"></span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:150%'><span
style='font-family:宋体'>可以看到试验成功。</span></p>

</div>

</body>

</html>
